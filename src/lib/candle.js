/*! @license candle.js v0.5.0 (c) 2011-2016 sabo2, MIT license
 *   https://bitbucket.org/sabo2/candle */
var _doc="undefined"!=typeof document?document:null,_2PI=2*Math.PI,_color=[],_hex=function(){for(var a=[],b=256;512>b;b++)a[b-256]=b.toString(16).substr(1);return a}(),Candle={version:"0.5.0",wrapper:{},addWrapper:function(a,b){a=a.replace(/\s+/g,"");var c=a.indexOf(":"),d="";c>=0&&(d=a.substr(c+1),a=a.substr(0,c));var e,f=function(){this.initialize&&this.initialize.apply(this,arguments)};if(d&&this.wrapper[d]){var g=this.wrapper[d];for(e in g.prototype)f.prototype[e]=g.prototype[e]}for(e in b)f.prototype[e]=b[e];f.prototype.constructor=f;var h={body:f,name:a,base:d};this.wrapper[h.name]=h.body},_order:[],enable:{},addType:function(a,b){this._order.push(a),this.enable[a]=!0,this.current||(this.current=a)},TypeList:function(a){for(var b=0;b<Candle._order.length;b++)this[Candle._order[b]]=Candle._order[b]===a},current:"",select:function(a){return this.enable[a]?(this.current=a,!0):!1},ME:null,initME:function(){var a=_doc.createElement("div");a.style.display="inline",a.style.position="absolute",a.style.top="0px",a.style.left="-9000px",a.innerHTML="",_doc.body.appendChild(a),void 0!==a.offsetHeight?this.ME=a:_doc.body.removeChild(a)},getoffsetHeight:function(a,b){var c;if(b.match(/(.+\s)?([0-9]+)px (.+)$/))c=+RegExp.$2;else if(this.ME){var d=this.ME;d.style.font=b,d.style.lineHeight="100%",d.innerHTML=a,c=d.offsetHeight}return c},color:_color,parse:function(a){if(!_color[a])if("rgb("===a.substr(0,4)){var b=a.match(/\d+/g);_color[a]=["#",_hex[b[0]],_hex[b[1]],_hex[b[2]]].join("")}else _color[a]=a;return _color[a]},getRectSize:function(a){return{width:a.offsetWidth||a.clientWidth||0,height:a.offsetHeight||a.clientHeight||0}},_counter:-1,getcanvasid:function(){return this._counter++,"_candle_"+this._counter},start:function(a,b,c){this.ME||"undefined"==typeof window||this.initME();var d;if(a.candleEnable)d=a.getContext("2d");else{var e=b;if(this.enable[e]||(e=this.current),!e||!this.enable[e])throw"No canvas environment is installed";d=new this.wrapper[e](a)}c&&c(d)}};"object"==typeof module&&"object"==typeof exports?module.exports=Candle:this.Candle=Candle,function(){function a(){if(this.parentNode){var a=this.parentNode._children,b=a.indexOf(this);return b>=0?a[b+1]:null}}function b(a){a.parentNode&&a.parentNode.removeChild(a),this._children.push(a),a.parentNode=this}function c(a){var b=this._children.indexOf(a);return b>=0&&(this._children.splice(b,1),a.parentNode=null),a}function d(a,b){a.parentNode&&a.parentNode.removeChild(a);var c=-1;b&&(c=this._children.indexOf(b)),-1===c?this.appendChild(a):this._children.splice(c,0,a)}function e(a,b){a=a.replace(/\*/g,"\\w+(#[w-]+)?"),a=new RegExp(a.replace(/\s+/g,"[^/]*?/([^/]+/)?")+"[^/]*$");for(var c=this.firstChild?[this.firstChild]:[],d=[];c.length>0;){var e=c.pop();if(h(e,this).match(a)&&(d.push(e),!b))break;e.nextSibling&&c.push(e.nextSibling),e.childNodes.length>0&&c.push(e.firstChild)}return b?d:d[0]||null}function f(a){return e.call(this,a,!0)}function g(a){return e.call(this,a,!1)}function h(a,b){for(var c="";a&&a!==b;){var d="";a.createElement||(d=a.tagName+(a._attr.id?"#"+a._attr.id:"")),c=d+(c?"/"+c:""),a=a.parentNode}return c}function i(){return this._children.reduce(function(a,b,c,d){return a+b.outerHTML},"")}function j(){var a=this.tagName,b="",c="";for(var d in this._attr)b+=" "+d+'="'+this._attr[d]+'"';for(var e in this.style)c+=e+":"+this.style[e]+";";return c&&(b+=' style="'+c+'"'),0===this._children.length?"<"+a+b+"/>":"<"+a+b+">"+this.innerHTML+"</"+a+">"}function k(a,b){for(;;){var c=b.match(/^\s*([^:]+?):([^;]+?);?/);if(!c)break;a.style[c[1]]=c[2],b=RegExp["$'"]}}function l(a,b){for(;;){var c=b.match(/^\s*([\w\-\:]+)(\=)?(['"](.+?)['"]|[^\s]+)?\s*/);if(!c)break;var d=c[1],e=c[4]||c[5]||"";b=RegExp["$'"],d&&("="===c[2]?"style"!==d?a.setAttribute(d,e):a.style=k(a,e):a.setAttribute(d,!0))}}function m(a,b){var c=[a],d=b.split(/(<.+?>)/g);return d.forEach(function(a){var b=c[c.length-1],d=null;if(!a.match(/^<\?xml/))if(a.match(/^<\w/)){var e=a.match(/<(\w+)\s*(.*)\/?>/);d=new n(e[1]),l(d,e[2]),b.appendChild(d),a.match(/\/>$/)||c.push(d)}else if(a.match(/^<\//))c.pop();else{if(a.match(/^[\s\t\r\n]*$/))return;b.appendChild(new o(a))}}),a}if(!_doc){var n=function(a){this.tagName=a,this._attr={},this.style={},this._children=[]};n.prototype={tagName:"",style:null,_attr:null,_children:null,parentNode:null,nodeType:1,get firstChild(){return this._children[0]},get lastChild(){return this._children[this._children.length-1]},get childNodes(){return this._children},get nextSibling(){return a.call(this)},appendChild:b,removeChild:c,insertBefore:d,setAttribute:function(a,b){this._attr[a]=b},setAttributeNS:function(a,b,c){this._attr[b]=c},getAttribute:function(a){return this._attr[a]||""},getAttributeNS:function(a,b){return this._attr[b]||""},removeAttribute:function(a){delete this._attr[a]},get id(){return this._attr.id||""},get nodeName(){return this.tagName},get innerHTML(){return i.call(this)},get outerHTML(){return j.call(this)},get textContent(){return this.innerHTML.replace(/<.+?>/g,"")},set textContent(a){this._children.forEach(function(a){this.removeChild(a)}.bind(this)),this.appendChild(new o(a))},querySelector:g,querySelectorAll:f};var o=function(a){this.data=a};o.prototype={_attr:{id:""},parentNode:null,nodeType:3,data:"",get firstChild(){return null},get childNodes(){return[]},get nextSibling(){return a.call(this)},get outerHTML(){return this.data}};var p=Candle.MockDocument=function(){this._children=[]};p.prototype={_children:null,nodeType:9,createElement:function(a){return new n(a)},createElementNS:function(a,b){return new n(b)},createTextNode:function(a){return new o(a)},get firstChild(){return this._children[0]},get lastChild(){return this._children[this._children.length-1]},get childNodes(){return this._children},appendChild:b,removeChild:c,insertBefore:d,get innerHTML(){return i.call(this)},get outerHTML(){return i.call(this)},querySelector:g,querySelectorAll:f,getElementById:function(a){return this.querySelector("#"+a)}};var q=Candle.MockXMLSerializer=function(){};q.prototype.serializeToString=function(a){return a.outerHTML};var r=Candle.MockDOMParser=function(){};r.prototype.parseFromString=function(a,b){var c=new p;return m(c,a)},_doc=document=new p,XMLSerializer=q,DOMParser=r}}(),Candle.addWrapper("wrapperbase",{initialize:function(a){this.fillStyle="black",this.strokeStyle="black",this.lineWidth=1,this.font="14px system",this.textAlign="center",this.textBaseline="middle",this.canvas=a,this.canvasid=Candle.getcanvasid(),this.child=null,this.currentLayerId="_empty",this.isedgearray={_empty:!1},this.isedge=!1,this.initElement(),this.initFunction(),this.initLayer();var b=this;this.canvas.getContext=function(a){return b},this.canvas.candleEnable=!0},rectcenter:function(a,b,c,d){this.rect(a-c,b-d,2*c,2*d)},fillRectCenter:function(a,b,c,d){this.fillRect(a-c,b-d,2*c,2*d)},strokeRectCenter:function(a,b,c,d){this.strokeRect(a-c,b-d,2*c,2*d)},shapeRectCenter:function(a,b,c,d){this.shapeRect(a-c,b-d,2*c,2*d)},vhide:function(){}}),function(){function a(a){return _doc.createElementNS(e,a)}function b(){var a="undefined"!=typeof navigator?navigator.userAgent||"":"";c=a.match(/Chrome/)?{"candle-top":-.72,top:-.95,hanging:-.72,middle:-.35,alphabetic:0,bottom:.25}:a.match(/AppleWebKit/)?{"candle-top":-.7,top:-.9,hanging:-.9,middle:-.35,alphabetic:0,bottom:.25}:a.match(/Trident/)?{"candle-top":-.74,top:-1.02,hanging:-1.02,middle:-.32,alphabetic:0,bottom:.45}:a.match(/Win/)?{"candle-top":-.7,top:-.85,hanging:-.85,middle:-.34,alphabetic:0,bottom:.15}:{"candle-top":-.76,top:-.9,hanging:-.9,middle:-.38,alphabetic:0,bottom:.08}}if("undefined"!=typeof document&&document.createElementNS&&("undefined"==typeof window||!window.opera)){var c,d="undefined"==typeof process?"html":"node",e=Candle.SVGNS="http://www.w3.org/2000/svg",f=Candle.XLINKNS="http://www.w3.org/1999/xlink",g="M",h="L",i="A",j="z",k="d",l="fill",m="stroke",n="stroke-width",o="shape-rendering",p="none",q={left:"start",center:"middle",right:"end"};Candle.addType("svg"),Candle.addWrapper("svg:wrapperbase",{initialize:function(a){this.use=new Candle.TypeList("svg"),c||b(),this.vid="",this.elements={},this._textcache={},this.target=null,this.cpath=[],this.lastpath="",this.freezepath=!1,Candle.wrapper.wrapperbase.prototype.initialize.call(this,a)},initElement:function(){"html"===d&&(this.canvas.style.overflow="hidden");var a=Candle.getRectSize(this.canvas),b=this.child=_doc.createElementNS(e,"svg");b.setAttribute("xmlns",e),b.setAttribute("xmlns:xlink",f),b.setAttribute("id",this.canvasid),b.setAttribute("font-size","10px"),b.setAttribute("font-family","sans-serif"),b.setAttribute("width",a.width),b.setAttribute("height",a.height),b.setAttribute("viewBox",[0,0,a.width,a.height].join(" ")),this.canvas.appendChild&&this.canvas.appendChild(b)},initFunction:function(){function a(a){return"html"===d?window.btoa(a):Buffer.isBuffer(a)?a.toString("base64"):new Buffer(a.toString(),"binary").toString("base64")}function b(a){return(a.outerHTML||(new XMLSerializer).serializeToString(a)).replace(/^<\?xml.+?\?>[\r\n]*/,"")}var c='<?xml version="1.0" encoding="UTF-8"?>\n',e=this.child;this.canvas.toDataURL=function(c,d){return"data:image/svg+xml;base64,"+a(b(e))},this.canvas.toBlob=function(a,d,f){a(new Blob([c+b(e)],{type:"image/svg+xml"}))},this.canvas.toBuffer=function(a,d){return c+b(e)}},initLayer:function(){this.setLayer();var a=Candle.getRectSize(this.canvas);this.rect(0,0,a.width,a.height),this.addVectorElement(!1,!1)},clear:function(){for(var a=this.child,b=a.firstChild;b;)a.removeChild(b),b=a.firstChild;this.vid="",this.elements={},this.target=this.child,this.setLayer(),this._textcache={}},setLayer:function(b,c){if(c=c||{},this.vid="",b){var d=[this.canvasid,"layer",b].join("_"),e=this.child.querySelector("#"+d);e||(e=a("g"),e.setAttribute("id",d),this.child.appendChild(e)),this.target=e}else this.target=this.child;this.currentLayerId=b?b:"_empty",c.rendering&&this.setRendering(c.rendering),this.freezepath=!!c&&c.freeze},setRendering:function(a){this.target.setAttribute(o,a)},changeSize:function(a,b){"html"===d&&(this.canvas.style.width=a+"px",this.canvas.style.height=b+"px");var c=this.child;c.setAttribute("width",a),c.setAttribute("height",b);var e=c.getAttribute("viewBox").split(/ /);c.setAttribute("viewBox",[e[0],e[1],a,b].join(" "))},translate:function(a,b){var c=this.child.getAttribute("viewBox").split(/ /);c[0]=-a,c[1]=-b,this.child.setAttribute("viewBox",c.join(" "))},beginPath:function(){this.cpath=[],this.lastpath=""},closePath:function(){this.cpath.push(j),this.lastpath=j},moveTo:function(a,b){this.cpath.push(g,a,b),this.lastpath=g},lineTo:function(a,b){this.lastpath!==h&&this.cpath.push(h),this.cpath.push(a,b),this.lastpath=h},rect:function(a,b,c,d){this.cpath.push(g,a,b,h,a+c,b,a+c,b+d,a,b+d,j),this.lastpath=j},arc:function(a,b,c,d,e,f){var h,j,k,l;e-d>=_2PI?(h=a+c,j=b,k=a+c,l=b):(h=a+c*Math.cos(d),j=b+c*Math.sin(d),k=a+c*Math.cos(e),l=b+c*Math.sin(e)),e-d>=_2PI&&(j+=.125);var m=d>e!=Math.abs(e-d)>Math.PI,n=f^m?1:0,o=0===n^m?1:0;this.cpath.push(g,h,j,i,c,c,0,n,o,k,l),this.lastpath=i},fill:function(){this.addVectorElement(!0,!1)},stroke:function(){this.addVectorElement(!1,!0)},shape:function(){this.addVectorElement(!0,!0)},fillRect:function(a,b,c,d){var e=this.cpath;this.cpath=[],this.rect(a,b,c,d),this.addVectorElement(!0,!1),this.cpath=e},strokeRect:function(a,b,c,d){var e=this.cpath;this.cpath=[],this.rect(a,b,c,d),this.addVectorElement(!1,!0),this.cpath=e},shapeRect:function(a,b,c,d){var e=this.cpath;this.cpath=[],this.rect(a,b,c,d),this.addVectorElement(!0,!0),this.cpath=e},setLinePath:function(){for(var a=arguments,b=a.length,c=b-(1|b?1:2),d=[],e=0;c>e;e+=2)d[e>>1]=[a[e],a[e+1]];this.beginPath(),this.setLinePath_com.call(this,d),a[b-1]&&this.cpath.push(j)},setOffsetLinePath:function(){for(var a=arguments,b=a.length,c=b-(1|b?1:2),d=[],e=0;c-2>e;e+=2)d[e>>1]=[a[e+2]+a[0],a[e+3]+a[1]];this.beginPath(),this.setLinePath_com.call(this,d),a[b-1]&&this.cpath.push(j)},setLinePath_com:function(a){for(var b=0,c=a.length;c>b;b++)this.cpath.push(0===b?g:h),this.cpath.push(a[b][0],a[b][1])},strokeLine:function(a,b,c,d){var e=this.cpath;this.cpath=[g,a,b,h,c,d],this.addVectorElement(!1,!0),this.cpath=e},strokeDashedLine:function(a,b,c,d,e){var f=this.cpath;this.cpath=[g,a,b,h,c,d];var i=this.addVectorElement(!1,!0);i.setAttribute("stroke-dasharray",e.join(" ")),this.cpath=f},strokeCross:function(a,b,c){var d=this.cpath;this.cpath=[g,a-c,b-c,h,a+c,b+c,g,a-c,b+c,h,a+c,b-c],this.addVectorElement(!1,!0),this.cpath=d},fillCircle:function(a,b,c){var d=this.cpath;this.cpath=[],this.arc(a,b,c,0,_2PI,!1),this.cpath.push(j),this.addVectorElement(!0,!1),this.cpath=d},strokeCircle:function(a,b,c){var d=this.cpath;this.cpath=[],this.arc(a,b,c,0,_2PI,!1),this.cpath.push(j),this.addVectorElement(!1,!0),this.cpath=d},shapeCircle:function(a,b,c){var d=this.cpath;this.cpath=[],this.arc(a,b,c,0,_2PI,!1),this.cpath.push(j),this.addVectorElement(!0,!0),this.cpath=d},getDefsElement:function(){var a=this.child.querySelector("defs");return a||(a=document.createElementNS(e,"defs"),this.child.insertBefore(a,this.child.firstChild||null)),a},getImageElement:function(b){for(var c=this.getDefsElement(),d=null,e=c.querySelectorAll("image"),g=0;g<e.length;g++)if(e[g].getAttributeNS(f,"href")===b.src){d=e[g];break}return d||(d=a("image"),d.setAttribute("id",[this.canvasid,"img",e.length].join("_")),d.setAttribute("width",b.width),d.setAttribute("height",b.height),d.setAttributeNS(f,"xlink:href",b.src),c.appendChild(d)),d},getImageSymbol:function(a,b,c,d,g){for(var h=this.getDefsElement(),i=[b,c,d,g].join(" "),j=null,k=h.querySelectorAll("symbol"),l=0;l<k.length;l++)if(k[l].getAttribute("viewBox")===i){j=k[l];break}if(!j){j=document.createElementNS(e,"symbol"),j.setAttribute("id",[this.canvasid,"symimg",k.length].join("_")),j.setAttribute("viewBox",i);var m=document.createElementNS(e,"use");m.setAttributeNS(f,"xlink:href","#"+this.getImageElement(a).getAttribute("id")),j.appendChild(m),h.appendChild(j)}return j},fillText:function(a,b,c){var d=this.vid?this.elements[this.vid]:null;if(a&&this.fillStyle&&"none"!==this.fillStyle){var e=this.fillText_main(d,a,b,c);!d&&this.vid&&(this.elements[this.vid]=e)}else d&&this.hide(d);this.vid=""},fillText_main:function(b,d,e,f){var g=!b,h=this.vid?this._textcache[this.vid]||{}:{};if(g?b=a("text"):this.show(b),b.getAttribute(l)!==this.fillStyle&&b.setAttribute(l,this.fillStyle),h.x!==e||h.y!==f||h.ta!==this.textAlign||h.tb!==this.textBaseline||h.font!==this.font){var i=f-Candle.getoffsetHeight(d,this.font)*c[this.textBaseline.toLowerCase()],j=q[this.textAlign.toLowerCase()];b.getAttribute("x")!==e&&b.setAttribute("x",e),b.getAttribute("y")!==i&&b.setAttribute("y",i),b.getAttribute("text-anchor")!==j&&b.setAttribute("text-anchor",j),h.x=e,h.y=f,h.ta=this.textAlign,h.tb=this.textBaseline}if(h.font!==this.font){if(this.font.match(/(.+\s)?([0-9]+)px (.+)$/)){var k=RegExp.$1,m=RegExp.$2,n=RegExp.$3;b.setAttribute("font-size",m),n.match(/^sans\-serif$/i)?b.removeAttribute("font-family"):b.setAttribute("font-family",n),k.match(/(italic|oblique)/)?b.setAttribute("font-style",RegExp.$1):b.removeAttribute("font-style"),k.match(/(bold|bolder|lighter|[1-9]00)/)?b.setAttribute("font-weight",RegExp.$1):b.removeAttribute("font-weight")}else b.setAttribute("font",this.font);h.font=this.font}return b.textContent!==d&&(b.textContent=d),this.vid&&(this._textcache[this.vid]=h),g&&this.target.appendChild(b),b},drawImage:function(a,b,c,d,e,f,g,h,i){var j=this.vid?this.elements[this.vid]:null;if(a){void 0===d&&(d=a.width,e=a.height),void 0===f&&(f=b,b=0,g=c,c=0,h=d,i=e);var k=this.drawImage_main(j,a,b,c,d,e,f,g,h,i);!j&&this.vid&&(this.elements[this.vid]=k)}else j&&this.hide(j);this.vid=""},drawImage_main:function(b,c,d,e,g,h,i,j,k,l){var m=!b;m?b=a("use"):this.show(b);var n=this.getImageSymbol(c,d,e,g,h).getAttribute("id");return b.getAttribute("x")!==i&&b.setAttribute("x",i),b.getAttribute("y")!==j&&b.setAttribute("y",j),b.getAttribute("width")!==k&&b.setAttribute("width",k),b.getAttribute("height")!==l&&b.setAttribute("height",l),b.getAttributeNS(f,"xlink:href")!=="#"+n&&b.setAttributeNS(f,"xlink:href","#"+n),m&&this.target.appendChild(b),b},addVectorElement:function(a,b){a=a&&!!this.fillStyle&&"none"!==this.fillStyle,b=b&&!!this.strokeStyle&&"none"!==this.strokeStyle;var c=this.vid?this.elements[this.vid]:null,d=null;return a||b?(d=this.addVectorElement_main(c,a,b),!c&&this.vid&&(this.elements[this.vid]=d)):c&&this.hide(c),this.vid="",d},addVectorElement_main:function(b,c,d){var e=!b;if(e?(b=a("path"),b.setAttribute(l,p),b.setAttribute(m,p)):this.show(b),!this.freezepath||e){var f=this.cpath.join(" "),g=d?this.lineWidth:null;b.getAttribute(k)!==f&&b.setAttribute(k,f),b.getAttribute(n)!==g&&b.setAttribute(n,g)}var h=c?this.fillStyle:p,i=d?this.strokeStyle:p;return b.getAttribute(l)!==h&&b.setAttribute(l,h),b.getAttribute(m)!==i&&b.setAttribute(m,i),e&&this.target.appendChild(b),b},vhide:function(a){var b=this.elements[this.vid];b&&this.hide(b)},show:function(a){a.removeAttribute("display")},hide:function(a){a.setAttribute("display","none")}})}}(),function(){function a(){var a="undefined"!=typeof navigator?navigator.userAgent||"":"";d=0,d=a.match(/Chrome/)?-.72:a.match(/AppleWebKit/)?-.7:a.match(/Trident/)?-.74:a.match(/Win/)?-.7:-.76}var b="html";try{Candle.Canvas=require("canvas"),b="node"}catch(c){if(document.createElement("canvas").probablySupportsContext&&!document.createElement("canvas").probablySupportsContext("2d"))return}var d;Candle.addType("canvas"),Candle.addWrapper("canvas:wrapperbase",{initialize:function(b){this.context=null,this.use=new Candle.TypeList("canvas"),d||a(),this.x0=0,this.y0=0,Candle.wrapper.wrapperbase.prototype.initialize.call(this,b)},setkey:function(a){return this},hidekey:function(a){return this},release:function(a){return this},initElement:function(){var a=this.child="html"===b?_doc.createElement("canvas"):new Candle.Canvas;"html"===b&&(this.canvas.style.overflow="hidden");var c=Candle.getRectSize(this.canvas);a.id=this.canvasid,a.width=c.width,a.height=c.height,"html"===b&&(a.style.width=c.width+"px",a.style.height=c.height+"px",this.canvas.appendChild(a)),this.context=a.getContext("2d")},initFunction:function(){function a(a){return"html"===b?window.atob(a):new Buffer(RegExp.$2,"base64").toString("binary")}var c=this.child;this.canvas.toDataURL=function(a,b){return c.toDataURL(a||void 0,b)},this.canvas.toBlob=function(b,d,e){if("function"==typeof c.toBlob)c.toBlob(b,d,e);else{c.toDataURL(d||void 0,e).match(/data:(.*);base64,(.*)/);for(var f=a(RegExp.$2),g=f.length,h=new Uint8Array(g),i=0;g>i;i++)h[i]=f.charCodeAt(i);b(new Blob([h.buffer],{type:RegExp.$1}))}},this.canvas.toBuffer=function(d,e){var f=c.toDataURL(d||void 0,e).replace(/^data:image\/\w+?;base64,/,"");if("node"===b)return new Buffer(f,"base64");var g;if("undefined"!=typeof Uint8Array){var h=a(f);g=new Uint8Array(h.length);for(var i=0;i<h.length;i++)g[i]=h.charCodeAt(i)}else g=a(f);return g}},initLayer:function(){this.setLayer()},clear:function(){if(this.setProperties(!0,!0),this.context.setTransform(1,0,0,1,0,0),this.context.translate(this.x0,this.y0),"html"===b){var a=Candle.getRectSize(this.canvas);this.context.clearRect(0,0,a.width,a.height)}},setLayer:function(a,b){var c=this.currentLayerId=a?a:"_empty";this.isedge=this.isedgearray[void 0!==this.isedgearray[c]?c:"_empty"],this.setEdgeStyle(),b=b||{},b.rendering&&this.setRendering(b.rendering)},setEdgeStyle:function(){if("node"!==b){var a=this.canvas.style;"imageRendering"in a&&(a.imageRendering="",this.isedge&&(a.imageRendering="pixelated",a.imageRendering||(a.imageRendering="-webkit-optimize-contrast"),a.imageRendering||(a.imageRendering="-moz-crisp-edges"),a.imageRendering||(a.imageRendering="-o-crisp-edges")))}},setRendering:function(a){this.isedge=this.isedgearray[this.currentLayerId]="crispEdges"===a,this.setEdgeStyle()},changeSize:function(a,c){if("html"===b){var d=this.canvas;d.style.width=a+"px",d.style.height=c+"px"}var e=this.child;if("html"===b){var f=parseInt(e.style.left),g=parseInt(e.style.top);a+=0>f?-f:0,c+=0>g?-g:0,e.style.width=a+"px",e.style.height=c+"px"}e.width=a,e.height=c},translate:function(a,b){this.x0=a,this.y0=b,this.context.translate(a,b)},setProperties:function(a,b){a=a&&!!this.fillStyle&&"none"!==this.fillStyle,b=b&&!!this.strokeStyle&&"none"!==this.strokeStyle;var c=this.context;return a&&(c.fillStyle=this.fillStyle),b&&(c.strokeStyle=this.strokeStyle),c.lineWidth=this.lineWidth,c.font=this.font,c.textAlign=this.textAlign,c.textBaseline=this.textBaseline,a||b},beginPath:function(){this.context.beginPath()},closePath:function(){this.context.closePath()},moveTo:function(a,b){this.context.moveTo(a,b)},lineTo:function(a,b){this.context.lineTo(a,b)},rect:function(a,b,c,d){this.context.rect(a,b,c,d)},arc:function(a,b,c,d,e,f){this.context.arc(a,b,c,d,e,f)},fill:function(){this.setProperties(!0,!1)&&this.context.fill()},stroke:function(){this.setProperties(!1,!0)&&this.context.stroke()},shape:function(){if(this.setProperties(!0,!0)){var a=this.context;this.fillStyle&&"none"!==this.fillStyle&&a.fill(),this.strokeStyle&&"none"!==this.strokeStyle&&a.stroke()}},fillRect:function(a,b,c,d){this.setProperties(!0,!1)&&this.context.fillRect(a,b,c,d)},strokeRect:function(a,b,c,d){this.setProperties(!1,!0)&&this.context.strokeRect(a,b,c,d)},shapeRect:function(a,b,c,d){if(this.setProperties(!0,!0)){var e=this.context;this.fillStyle&&"none"!==this.fillStyle&&e.fillRect(a,b,c,d),this.strokeStyle&&"none"!==this.strokeStyle&&e.strokeRect(a,b,c,d)}},setLinePath:function(){for(var a=arguments,b=a.length,c=b-(1|b?1:2),d=[],e=0;c>e;e+=2)d[e>>1]=[a[e],a[e+1]];this.context.beginPath(),this.setLinePath_com.call(this,d),a[b-1]&&this.context.closePath()},setOffsetLinePath:function(){for(var a=arguments,b=a.length,c=b-(1|b?1:2)-2,d=[],e=0;c>e;e+=2)d[e>>1]=[a[e+2]+a[0],a[e+3]+a[1]];this.context.beginPath(),this.setLinePath_com.call(this,d),a[b-1]&&this.context.closePath()},setLinePath_com:function(a){for(var b=0,c=a.length;c>b;b++){var d=a[b];0===b?this.context.moveTo(d[0],d[1]):this.context.lineTo(d[0],d[1])}},strokeLine:function(a,b,c,d){if(this.setProperties(!1,!0)){var e=this.context;e.beginPath(),e.moveTo(a,b),e.lineTo(c,d),e.stroke()}},strokeDashedLine:function(a,b,c,d,e){this.strokeDashedLine=this.context.setLineDash?function(a,b,c,d,e){var f=this.context;this.setProperties(!1,!0)&&(f.beginPath(),f.moveTo(a,b),f.lineTo(c,d),f.setLineDash(e),f.stroke(),f.setLineDash([]))}:function(a,b,c,d,e){e.length%2===1&&(e=e.concat(e));var f=Math.sqrt((c-a)*(c-a)+(d-b)*(d-b)),g=0,h=0,i=null,j=null;if(a!==c&&(i=(d-b)/(c-a),j=i*i+1),this.setProperties(!1,!0)){var k=this.context;for(k.beginPath(),k.moveTo(a,b);f>g;){var l,m;if(null!==i){var n=Math.sqrt(g*g/j);l=a+n,m=b+i*n}else l=a,m=b+g;0===(1&h)?k.moveTo(l,m):k.lineTo(l,m),g+=e[h],h++,h>=e.length&&(h=0)}k.stroke()}},this.strokeDashedLine(a,b,c,d,e)},strokeCross:function(a,b,c){if(this.setProperties(!1,!0)){var d=this.context;d.beginPath(),d.moveTo(a-c,b-c),d.lineTo(a+c,b+c),d.moveTo(a-c,b+c),d.lineTo(a+c,b-c),d.stroke()}},fillCircle:function(a,b,c){if(this.setProperties(!0,!1)){var d=this.context;d.beginPath(),d.arc(a,b,c,0,_2PI,!1),d.fill()}},strokeCircle:function(a,b,c){if(this.setProperties(!1,!0)){var d=this.context;d.beginPath(),d.arc(a,b,c,0,_2PI,!1),d.stroke()}},shapeCircle:function(a,b,c){if(this.setProperties(!0,!0)){var d=this.context;d.beginPath(),d.arc(a,b,c,0,_2PI,!1),this.fillStyle&&"none"!==this.fillStyle&&d.fill(),this.strokeStyle&&"none"!==this.strokeStyle&&d.stroke()}},fillText:function(a,b,c){a&&this.setProperties(!0,!1)&&("candle-top"===this.textBaseline&&(c-=Candle.getoffsetHeight(a,this.font)*d,this.context.textBaseline="alphabetic"),this.context.fillText(a,b,c))},drawImage:function(){arguments[0]&&this.context.drawImage.apply(this.context,arguments)}})}();