/*! @license pzpr.js v3.4.0 (c) 2009-2014 sabo2, MIT license
 *   https://bitbucket.org/sabo2/pzprv3 */
pzpr.createCustoms("nagenawa",{"MouseEvent@nagenawa":{mouseinput:function(){this.owner.playmode?this.mousestart||this.mousemove?this.btn.Left&&this.inputLine():this.mouseend&&this.notInputted()&&this.inputMB():this.owner.editmode&&(this.mousestart||this.mousemove?this.inputborder():this.mouseend&&this.notInputted()&&this.inputqnum())},inputRed:function(){this.dispRedLine()}},"MouseEvent@ringring":{mouseinput:function(){this.owner.playmode?(this.mousestart||this.mousemove)&&(this.btn.Left?this.inputLine():this.btn.Right&&this.inputpeke()):this.owner.editmode&&this.mousestart&&this.inputblock()},inputblock:function(){var a=this.getcell();a.isnull||(a.setQues(0===a.getQues()?1:0),a.draw())}},"KeyEvent@nagenawa":{enablemake:!0},Cell:{nummaxfunc:function(){return Math.min(this.maxnum,this.owner.board.rooms.getCntOfRoomByCell(this))},minnum:0},"Border@ringring":{enableLineNG:!0},Board:{qcols:8,qrows:8,hasborder:1},LineManager:{isCenterLine:!0,isLineCross:!0},"AreaRoomManager@nagenawa":{enabled:!0,hastop:!0},Flags:{redline:!0,irowake:1},Graphic:{initialize:function(){this.Common.prototype.initialize.call(this),this.gridcolor=this.gridcolor_SLIGHT},paint:function(){this.drawBGCells(),this.drawDashedGrid(),"nagenawa"===this.owner.pid?(this.drawNumbers(),this.drawMBs(),this.drawBorders()):"ringring"===this.owner.pid&&this.drawBlackCells(),this.drawLines(),"ringring"===this.owner.pid&&this.drawPekes(),this.drawChassis(),this.drawTarget()},drawNumber1:function(a){var b=["cell",a.id].join("_");if(-1!==a.qnum){var c=a.qnum>=0?""+a.qnum:"?",d=a.bx*this.bw,e=a.by*this.bh;this.dispnum(b,5,c,.45,this.fontcolor,d,e)}else this.hidenum(b)}},"Graphic@ringring":{getCellColor:function(a){return 1===a.ques?this.cellcolor:null},drawTarget:function(){}},"Encode@nagenawa":{decodePzpr:function(){this.decodeBorder(),this.decodeRoomNumber16()},encodePzpr:function(){this.encodeBorder(),this.encodeRoomNumber16()}},"Encode@ringring":{decodePzpr:function(){this.decodeBlockCell()},encodePzpr:function(){this.encodeBlockCell()},decodeBlockCell:function(){var a=0,b=0,c=this.outbstr,d=this.owner.board;for(b=0;b<c.length;b++){var e=c.charAt(b);if(this.include(e,"0","9")||this.include(e,"a","z")?(a+=parseInt(e,36),d.cell[a].ques=1):"."==e&&(a+=35),a++,a>=d.cellmax){b++;break}}this.outbstr=c.substr(b)},encodeBlockCell:function(){for(var a="",b=0,c=this.owner.board,d=0;d<c.cellmax;d++){var e="";1===c.cell[d].ques?e=".":b++,e?(a+=b.toString(36),b=0):36==b&&(a+=".",b=0)}this.outbstr+=a}},"FileIO@nagenawa":{decodeData:function(){this.decodeAreaRoom(),this.decodeCellQnum(),this.decodeBorderLine(),this.decodeCellQsub()},encodeData:function(){this.encodeAreaRoom(),this.encodeCellQnum(),this.encodeBorderLine(),this.encodeCellQsub()}},"FileIO@ringring":{decodeData:function(){this.decodeCellBlock(),this.decodeBorderLine()},encodeData:function(){this.encodeCellBlock(),this.encodeBorderLine()},decodeCellBlock:function(){this.decodeCell(function(a,b){"1"===b&&(a.ques=1)})},encodeCellBlock:function(){this.encodeCell(function(a){return 1===a.ques?"1 ":"0 "})}},AnsCheck:{checkAns:function(){var a=this.owner,b=a.board,c=a.pid;if(!this.checkNoLine())return"brNoLine";if("ringring"===c&&!this.checkLineOnBlackCell())return"lnOnBcell";var d=b.rooms.enabled?b.getRoomInfo():null;return"nagenawa"!==c||this.checkOverLineCount(d)?this.checkLineCount(3)?this.checkLineCount(1)?"nagenawa"!==c||this.checkLessLineCount(d)?this.checkAllLoopRect()?"ringring"!==c||this.checkUnreachedWhiteCell()?null:"ceEmpty":"lnNotRect":"bkLineLt":"lnDeadEnd":"lnBranch":"bkLineGt"},checkNoLine:function(){for(var a=this.owner.board,b=0;b<a.bdmax;b++)if(a.border[b].isLine())return!0;return!1},checkLineOnBlackCell:function(){return this.checkAllCell(function(a){return 1===a.getQues()&&a.lcnt()>0})},checkOverLineCount:function(a){return this.checkLinesInArea(a,function(a,b,c,d){return 0>=d||d>=c})},checkLessLineCount:function(a){return this.checkLinesInArea(a,function(a,b,c,d){return 0>=d||c>=d})},checkUnreachedWhiteCell:function(){return this.checkAllCell(function(a){return 0===a.lcnt()&&0===a.getQues()})},checkAllLoopRect:function(){for(var a=!0,b=this.owner.board,c=b.getLineInfo(),d=1;d<=c.max;d++){var e=c.room[d].blist;if(!this.isLoopRect(e)){if(this.checkOnly)return!1;a&&b.border.seterr(-1),e.seterr(1),a=!1}}return a},isLoopRect:function(a){for(var b=this.owner.board,c=b.maxbx,d=b.minbx,e=b.maxby,f=b.minby,g=0;g<a.length;g++)c>a[g].bx&&(c=a[g].bx),d<a[g].bx&&(d=a[g].bx),e>a[g].by&&(e=a[g].by),f<a[g].by&&(f=a[g].by);for(var g=0;g<a.length;g++){var h=a[g];if(h.bx!==c&&h.bx!==d&&h.by!==e&&h.by!==f)return!1}return!0}},FailCode:{lnNotRect:["長方形か正方形でない輪っかがあります。","there is a non-rectangle loop."],bkLineGt:["数字のある部屋と線が通過するマスの数が違います。","the number of the cells that is passed any line in the room and the number written in the room is diffrerent."],bkLineLt:["数字のある部屋と線が通過するマスの数が違います。","the number of the cells that is passed any line in the room and the number written in the room is diffrerent."],ceEmpty:["白マスの上に線が引かれていません。","there is no line on the white cell."]}});