/*! @license pzpr.js v3.4.0 (c) 2009-2014 sabo2, MIT license
 *   https://bitbucket.org/sabo2/pzprv3 */
pzpr.createCustoms("yajitatami",{MouseEvent:{mouseinput:function(){this.owner.playmode?(this.mousestart||this.mousemove)&&(this.btn.Left&&this.isBorderMode()?this.inputborder():this.inputQsubLine()):this.owner.editmode&&(this.mousestart||this.mousemove?this.isBorderMode()?this.inputborder():this.inputdirec():this.mouseend&&this.notInputted()&&this.inputqnum())}},KeyEvent:{enablemake:!0,moveTarget:function(a){return this.isSHIFT?!1:this.moveTCell(a)},keyinput:function(a){this.key_inputdirec(a)||this.key_inputqnum(a)}},Board:{qcols:8,qrows:8,hasborder:1},AreaRoomManager:{enabled:!0},Graphic:{initialize:function(){this.Common.prototype.initialize.call(this),this.gridcolor=this.gridcolor_DLIGHT,this.setBorderColorFunc("qans")},paint:function(){this.drawBGCells(),this.drawDashedGrid(),this.drawQansBorders(),this.drawQuesBorders(),this.drawArrowNumbers(),this.drawBorderQsubs(),this.drawChassis(),this.drawTarget()}},Encode:{decodePzpr:function(){this.decodeArrowNumber16(),this.decodeBorder()},encodePzpr:function(){this.encodeArrowNumber16(),this.encodeBorder_if_exist()},encodeBorder_if_exist:function(){for(var a=0;a<this.owner.board.bdmax;a++)if(1===this.owner.board.border[a].ques){this.encodeBorder();break}}},FileIO:{decodeData:function(){this.decodeCellDirecQnum(),this.decodeBorderQues(),this.decodeBorderAns()},encodeData:function(){this.encodeCellDirecQnum(),this.encodeBorderQues(),this.encodeBorderAns()}},AnsCheck:{checkAns:function(){if(!this.checkBorderCount(4,0))return"bdCross";if(!this.checkArrowNumber_border())return"arNoAdjBd";var a=this.owner.board.getRoomInfo();return this.checkTatamiLength(a)?this.checkArrowNumber_tatami()?this.checkTatamiSize(a)?this.checkTatamiBreadth(a)?null:"bkWidthGt1":"bkSizeNe":"anTatamiNe":"bkSize1"},checkTatamiLength:function(a){return this.checkAllArea(a,function(a,b,c){return c>1})},checkTatamiSize:function(a){return this.checkAllArea(a,function(a,b,c,d){return 0>d||d===c})},checkTatamiBreadth:function(a){return this.checkAllArea(a,function(a,b){return 1===a||1===b})},checkArrowNumber_tatami:function(){for(var a=pzpr.consts,b=!0,c=this.owner.board,d=0;d<c.cellmax;d++){var e=c.cell[d];if(e.isValidNum()){var f,g=e.bx,h=e.by,i=e.getQdir();if(i===a.UP)f=c.borderinside(g,c.minby,g,h);else if(i===a.DN)f=c.borderinside(g,h,g,c.maxby);else if(i===a.LT)f=c.borderinside(c.minbx,h,g,h);else{if(i!==a.RT)continue;f=c.borderinside(g,h,c.maxbx,h)}var j=f.filter(function(a){return a.isBorder()}).length;if(e.getQnum()!==j){if(this.checkOnly)return!1;e.seterr(1),b=!1}}}return b},checkArrowNumber_border:function(){for(var a=!0,b=this.owner.board,c=0;c<b.cellmax;c++){var d=b.cell[c],e=d.getQdir();if(d.isValidNum()&&e&&!d.getaddr().movedir(e,1).getb().isBorder()){if(this.checkOnly)return!1;d.seterr(1),a=!1}}return a}},FailCode:{bkSizeNe:["数字とタタミの大きさが違います。","The size of tatami and the number written in Tatami is different."],bkSize1:["長さが１マスのタタミがあります。","The length of the tatami is one."],anTatamiNe:["矢印の方向にあるタタミの数が正しくありません。","The number of tatamis are not correct."],arNoAdjBd:["矢印の方向に境界線がありません。","There is no border in front of the arrowed number."]}});