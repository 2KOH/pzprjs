/*! @license pzpr.js v3.4.0 (c) 2009-2014 sabo2, MIT license
 *   https://bitbucket.org/sabo2/pzprv3 */
pzpr.createCustoms("barns",{MouseEvent:{mouseinput:function(){this.owner.playmode?this.btn.Left?this.mousestart||this.mousemove?this.inputLine():this.mouseend&&this.notInputted()&&this.inputpeke():this.btn.Right&&(this.mousestart||this.mousemove)&&this.inputpeke():this.owner.editmode&&(this.mousestart||this.mousemove)&&(this.btn.Left?this.inputborder():this.btn.Right&&this.inputIcebarn())},inputRed:function(){this.dispRedLine()},inputIcebarn:function(){var a=this.getcell();a.isnull||a===this.mouseCell||(null===this.inputData&&(this.inputData=a.ice()?0:6),a.setQues(this.inputData),a.draw(),this.mouseCell=a)}},Border:{enableLineNG:!0,isLineNG:function(){return 1===this.ques}},Board:{qcols:8,qrows:8,hasborder:1},LineManager:{isCenterLine:!0,isLineCross:!0},Flags:{redline:!0,irowake:!0},Graphic:{initialize:function(){this.Common.prototype.initialize.call(this),this.gridcolor=this.gridcolor_LIGHT,this.linecolor=this.linecolor_LIGHT,this.errbcolor1=this.errbcolor1_DARK,this.setBGCellColorFunc("icebarn"),this.maxYdeg=.7},paint:function(){this.drawBGCells(),this.drawDashedGrid(),this.drawBorders(),this.drawLines(),this.drawPekes(),this.drawChassis()}},Encode:{decodePzpr:function(){this.decodeBarns(),this.decodeBorder()},encodePzpr:function(){this.encodeBarns(),this.encodeBorder()},decodeBarns:function(){for(var a=0,b=this.outbstr,c=this.owner.board,d=[16,8,4,2,1],e=0;e<b.length;e++){for(var f=parseInt(b.charAt(e),32),g=0;5>g;g++)a<c.cellmax&&(c.cell[a].ques=f&d[g]?6:0,a++);if(a>=c.cellmax)break}this.outbstr=b.substr(e+1)},encodeBarns:function(){for(var a="",b=0,c=0,d=this.owner.board,e=[16,8,4,2,1],f=0;f<d.cellmax;f++)6===d.cell[f].ques&&(c+=e[b]),b++,5==b&&(a+=c.toString(32),b=0,c=0);b>0&&(a+=c.toString(32)),this.outbstr+=a}},FileIO:{decodeData:function(){this.decodeCell(function(a,b){"1"===b&&(a.ques=6)}),this.decodeBorderQues(),this.decodeBorderLine()},encodeData:function(){this.encodeCell(function(a){return 6===a.ques?"1 ":". "}),this.encodeBorderQues(),this.encodeBorderLine()}},AnsCheck:{checkAns:function(){return this.checkLineCount(3)?this.checkCrossOutOfIce()?this.checkIceLines()?this.checkOneLoop()?this.checkLineCount(0)?this.checkLineCount(1)?null:"lnDeadEnd":"ceEmpty":"lnPlLoop":"lnCurveOnIce":"lnCrossExIce":"lnBranch"},checkCrossOutOfIce:function(){return this.checkAllCell(function(a){return 4===a.lcnt()&&!a.ice()})}},FailCode:{ceEmpty:["線が引かれていないマスがあります。","there is an empty cell."]}});