/*! @license pzpr.js v3.4.0 (c) 2009-2014 sabo2, MIT license
 *   https://bitbucket.org/sabo2/pzprv3 */
!function(){var a=pzpr.consts;pzpr.createCustoms("yajirin",{MouseEvent:{mouseinput:function(){this.owner.playmode?this.mousestart||this.mousemove?this.btn.Left?this.inputLine():this.btn.Right&&this.inputcell():this.mouseend&&this.notInputted()&&this.inputcell():this.owner.editmode&&(this.mousestart||this.mousemove?this.inputdirec():this.mouseend&&this.notInputted()&&this.inputqnum())},inputRed:function(){this.dispRedLine()}},KeyEvent:{enablemake:!0,enableplay:!0,moveTarget:function(a){return this.isSHIFT?!1:this.moveTCell(a)},keyinput:function(a){this.key_inputdirec(a)||this.key_inputqnum(a)}},Cell:{minnum:0,numberIsWhite:!0,noLP:function(){return this.isBlack()||this.isNum()}},Border:{enableLineNG:!0},Board:{hasborder:1},BoardExec:{adjustBoardData:function(a,b){this.adjustNumberArrow(a,b)}},LineManager:{isCenterLine:!0},Flags:{use:!0,redline:!0,irowake:1},Graphic:{initialize:function(){this.Common.prototype.initialize.call(this),this.gridcolor=this.gridcolor_LIGHT,this.dotcolor="rgb(255, 96, 191)"},paint:function(){this.drawBGCells(),this.drawDotCells(!1),this.drawGrid(),this.drawBlackCells(),this.drawArrowNumbers(),this.drawLines(),this.drawPekes(),this.drawChassis(),this.drawTarget()}},Encode:{decodePzpr:function(){this.decodeArrowNumber16()},encodePzpr:function(){this.encodeArrowNumber16()},decodeKanpen:function(){this.owner.fio.decodeCellDirecQnum_kanpen(!0)},encodeKanpen:function(){this.owner.fio.encodeCellDirecQnum_kanpen(!0)}},FileIO:{decodeData:function(){this.decodeCellDirecQnum(),this.decodeCellAns(),this.decodeBorderLine()},encodeData:function(){this.encodeCellDirecQnum(),this.encodeCellAns(),this.encodeBorderLine()},kanpenOpen:function(){this.decodeCellDirecQnum_kanpen(!1),this.decodeBorderLine()},kanpenSave:function(){this.encodeCellDirecQnum_kanpen(!1),this.encodeBorderLine()},decodeCellDirecQnum_kanpen:function(b){var c=[a.UP,a.LT,a.DN,a.RT];this.decodeCell(function(a,d){if("#"!==d||b)if("+"!==d||b){if("."!==d){var e=parseInt(d);a.qdir=c[(48&e)>>4],a.qnum=15&e}}else a.qsub=1;else a.qans=1})},encodeCellDirecQnum_kanpen:function(b){var c=[a.UP,a.LT,a.DN,a.RT];this.encodeCell(function(d){var e,f=d.qnum>=0&&d.qnum<16?d.qnum:-1;if(-1!==f&&d.qdir!==a.NDIR){for(e=0;4>e&&c[e]!==d.qdir;e++);return""+((e<<4)+(15&f))+" "}if(!b){if(1===d.qans)return"# ";if(1===d.qsub)return"+ "}return". "})}},AnsCheck:{checkAns:function(){return this.checkLineCount(3)?this.checkLineCount(4)?this.checkLineOnBlackCell()?this.checkAdjacentBlackCell()?this.checkLineCount(1)?this.checkArrowNumber()?this.checkOneLoop()?this.checkBlankCell()?null:"ceEmpty":"lnPlLoop":"anBcellNe":"lnDeadEnd":"bcAdjacent":"lnOnBcell":"lnCross":"lnBranch"},checkLineOnBlackCell:function(){return this.checkAllCell(function(a){return a.lcnt()>0&&a.isBlack()})},checkBlankCell:function(){return this.checkAllCell(function(a){return 0===a.lcnt()&&!a.isBlack()&&a.noNum()})},checkArrowNumber:function(){for(var a=!0,b=this.owner.board,c=0;c<b.cellmax;c++){var d=b.cell[c];if(d.isValidNum()&&0!==d.getQdir()&&!d.isBlack()){for(var e=d.getaddr(),f=d.getQdir(),g=0,h=new this.owner.CellList;;){e.movedir(f,2);var i=e.getc();if(i.isnull)break;h.add(i)}var g=h.filter(function(a){return a.isBlack()}).length;if(d.getQnum()!==g){if(this.checkOnly)return!1;d.seterr(1),h.seterr(1),a=!1}}}return a}},FailCode:{ceEmpty:["黒マスも線も引かれていないマスがあります。","There is an empty cell."]}})}();