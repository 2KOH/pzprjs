/*! @license pzpr.js v3.4.0-pre (c) 2009-2014 sabo2, MIT license
 *   https://bitbucket.org/sabo2/pzprv3 */
pzpr.createCustoms("roma",{MouseEvent:{mouseinput:function(){this.owner.playmode?this.mousestart||this.mousemove?this.inputarrow_cell():this.mouseend&&this.notInputted()&&this.inputqnum():this.owner.editmode&&(this.mousestart||this.mousemove?(this.mousestart&&this.checkBorderMode(),this.bordermode?this.inputborder():this.inputarrow_cell()):this.mouseend&&this.notInputted()&&this.inputqnum())},inputRed:function(){this.dispRoad()},dispRoad:function(){var a=this.getcell();if(!a.isnull){for(var b=[],c=this.owner.board,d=0;d<c.cellmax;d++)b[d]=-1;c.trackBall1(a.id,b);for(var d=0;d<c.cellmax;d++)1===b[d]?c.cell[d].seterr(2):2===b[d]&&c.cell[d].seterr(3);c.haserror=!0,this.owner.redraw()}}},KeyEvent:{enablemake:!0,moveTarget:function(a){return this.isSHIFT?!1:this.moveTCell(a)},keyinput:function(a){this.key_roma(a)},key_roma:function(a){"1"===a||this.isSHIFT&&a===this.KEYUP?a="1":"2"===a||this.isSHIFT&&a===this.KEYRT?a="4":"3"===a||this.isSHIFT&&a===this.KEYDN?a="2":"4"===a||this.isSHIFT&&a===this.KEYLT?a="3":"q"===a?a="5":!this.owner.editmode||"5"!==a&&"-"!==a?("6"===a||" "===a)&&(a=" "):a="s1",this.key_inputqnum(a)}},Cell:{numberAsObject:!0,nummaxfunc:function(){return this.owner.editmode?5:4}},Board:{qcols:8,qrows:8,isborder:1,trackBall1:function(a,b){var c=this.cell[a],d=c.getaddr(),e=c.getNum(),f=5===e;for(b[c.id]=0;e>=1&&4>=e;){d.movedir(e,2);var g=d.getc();if(g.isnull)break;if(-1!==b[g.id]){f=2===b[g.id];break}b[g.id]=0,e=g.getNum(),5===e&&(f=!0)}for(var h=[c];h.length>0;){var i=h.pop();if(i===c||-1===b[i.id]){b[i.id]=0;var j,e=i.getNum();j=i.up(),1===e||j.isnull||-1!==b[j.id]||2!==j.getNum()||h.push(j),j=i.dn(),2===e||j.isnull||-1!==b[j.id]||1!==j.getNum()||h.push(j),j=i.lt(),3===e||j.isnull||-1!==b[j.id]||4!==j.getNum()||h.push(j),j=i.rt(),4===e||j.isnull||-1!==b[j.id]||3!==j.getNum()||h.push(j)}}for(var k=0;k<this.cellmax;k++)0===b[k]&&(b[k]=f?2:1);return f}},BoardExec:{adjustBoardData:function(a,b){this.adjustCellArrow(a,b)}},AreaRoomManager:{enabled:!0},Graphic:{initialize:function(){this.Common.prototype.initialize.call(this),this.gridcolor=this.gridcolor_LIGHT,this.dotcolor=this.dotcolor_PINK,this.errbcolor2="rgb(255, 224, 192)",this.errbcolor3="rgb(192, 192, 255)"},paint:function(){this.drawBGCells(),this.drawGrid(),this.drawBorders(),this.drawCellArrows(),this.drawGoals(),this.drawHatenas(),this.drawChassis(),this.drawCursor()},getBGCellColor:function(a){return 1===a.error?this.errbcolor1:2===a.error?this.errbcolor2:3===a.error?this.errbcolor3:null},drawGoals:function(){for(var a=this.vinc("cell_circle","auto"),b=this.cw*this.circleratio[0],c="c_cir_",d=this.range.cells,e=0;e<d.length;e++){var f=d[e];5===f.qnum?(a.fillStyle=1===f.error?this.errcolor1:this.cellcolor,this.vnop(c+f.id,this.FILL)&&a.fillCircle(f.bx*this.bw,f.by*this.bh,b)):this.vhide(c+f.id)}}},Encode:{decodePzpr:function(){this.decodeBorder(),this.decodeNumber10()},encodePzpr:function(){this.encodeBorder(),this.encodeNumber10()}},FileIO:{decodeData:function(){this.decodeAreaRoom(),this.decodeCellQnum(),this.decodeCellAnumsub()},encodeData:function(){this.encodeAreaRoom(),this.encodeCellQnum(),this.encodeCellAnumsub()}},AnsCheck:{checkAns:function(){return this.checkSingleArrowInArea()?this.checkBalls()?null:"stopHalfway":"bkDupNum"},checkSingleArrowInArea:function(){var a=this.owner.board.getRoomInfo();return this.checkDifferentNumberInRoom(a,function(a){var b=a.getNum();return b>=1&&4>=b?b:-1})},checkBalls:function(){for(var a=[],b=this.owner.board,c=0;c<b.cellmax;c++)a[c]=5===b.cell[c].getNum()?2:-1;for(var c=0;c<b.cellmax;c++)if(-1===a[c]&&!b.trackBall1(c,a)&&this.checkOnly)return!1;for(var d=!0,c=0;c<b.cellmax;c++)1===a[c]&&(b.cell[c].seterr(1),d=!1);return d}},FailCode:{bkDupNum:["1つの領域に2つ以上の同じ矢印が入っています。","An area has plural same arrows."],stopHalfway:["ゴールにたどり着かないセルがあります。","A cell cannot reach a goal."]}});