/*! @license pzpr.js v3.4.0-pre (c) 2009-2014 sabo2, MIT license
 *   https://bitbucket.org/sabo2/pzprv3 */
pzpr.createCustoms("mashu",{MouseEvent:{mouseinput:function(){this.owner.playmode?this.btn.Left?this.mousestart||this.mousemove?this.inputLine():this.mouseend&&this.notInputted()&&this.inputpeke():this.btn.Right&&(this.mousestart||this.mousemove)&&this.inputpeke():this.owner.editmode&&this.mousestart&&this.inputqnum()},inputRed:function(){this.dispRedLine()}},KeyEvent:{enablemake:!0},Cell:{numberAsObject:!0,maxnum:2,setErrorPearl:function(){this.setCellLineError(1),this.ub().isLine()&&this.up().setCellLineError(0),this.db().isLine()&&this.dn().setCellLineError(0),this.lb().isLine()&&this.lt().setCellLineError(0),this.rb().isLine()&&this.rt().setCellLineError(0)}},Board:{isborder:1,uramashu:!1,revCircle:function(){this.uramashu&&this.revCircleMain()},revCircleMain:function(){for(var a=0;a<this.cellmax;a++){var b=this.cell[a];1===b.qnum?b.setQnum(2):2===b.qnum&&b.setQnum(1)}}},LineManager:{isCenterLine:!0},Flags:{redline:!0,irowake:1},Graphic:{initialize:function(){this.Common.prototype.initialize.call(this),this.gridcolor=this.gridcolor_LIGHT},paint:function(){this.drawBGCells(),this.drawDashedGrid(),this.drawCircles(),this.drawHatenas(),this.drawPekes(),this.drawLines(),this.drawChassis(),this.drawTarget()},getCircleStrokeColor:function(a){return 1===a.qnum?1===a.error?this.errcolor1:this.cellcolor:null},getCircleFillColor:function(a){return 1===a.qnum?1===a.error?this.errbcolor1:"white":2===a.qnum?1===a.error?this.errcolor1:this.cellcolor:null}},Encode:{decodePzpr:function(){this.decodeCircle(),this.owner.board.revCircle()},encodePzpr:function(){this.owner.board.revCircle(),this.encodeCircle(),this.owner.board.revCircle()},decodeKanpen:function(){this.owner.fio.decodeCellQnum_kanpen(),this.owner.board.revCircle()},encodeKanpen:function(){this.owner.board.revCircle(),this.owner.fio.encodeCellQnum_kanpen(),this.owner.board.revCircle()}},FileIO:{decodeData:function(){this.decodeCellQnum(),this.decodeBorderLine(),this.owner.board.revCircle()},encodeData:function(){this.owner.board.revCircle(),this.encodeCellQnum(),this.encodeBorderLine(),this.owner.board.revCircle()},kanpenOpen:function(){this.decodeCellQnum_kanpen(),this.decodeBorderLine(),this.owner.board.revCircle()},kanpenSave:function(){this.owner.board.revCircle(),this.encodeCellQnum_kanpen(),this.encodeBorderLine(),this.owner.board.revCircle()}},AnsCheck:{checkAns:function(){return this.checkLineCount(3)?this.checkLineCount(4)?this.checkWhitePearl1()?this.checkBlackPearl1()?this.checkBlackPearl2()?this.checkWhitePearl2()?this.checkNoLinePearl()?this.checkLineCount(1)?this.checkOneLoop()?null:"lnPlLoop":"lnDeadEnd":"mashuOnLine":"mashuWStNbr":"mashuBCvNbr":"mashuBStrig":"mashuWCurve":"lnCross":"lnBranch"},checkNoLinePearl:function(){return this.checkAllCell(function(a){return a.isNum()&&0==a.lcnt()})},checkWhitePearl1:function(){for(var a=!0,b=this.owner.board,c=0;c<b.cellmax;c++){var d=b.cell[c];if(1===d.getQnum()&&2===d.lcnt()&&!d.isLineStraight()){if(this.checkOnly)return!1;a&&b.border.seterr(-1),d.setCellLineError(1),a=!1}}return a},checkBlackPearl1:function(){for(var a=!0,b=this.owner.board,c=0;c<b.cellmax;c++){var d=b.cell[c];if(2===d.getQnum()&&2===d.lcnt()&&d.isLineStraight()){if(this.checkOnly)return!1;a&&b.border.seterr(-1),d.setCellLineError(1),a=!1}}return a},checkWhitePearl2:function(){for(var a=!0,b=this.owner.board,c=0;c<b.cellmax;c++){var d=b.cell[c];if(1===d.getQnum()&&2===d.lcnt()){var e=0;if(d.ub().isLine()&&2===d.up().lcnt()&&d.up().isLineStraight()&&e++,d.db().isLine()&&2===d.dn().lcnt()&&d.dn().isLineStraight()&&e++,d.lb().isLine()&&2===d.lt().lcnt()&&d.lt().isLineStraight()&&e++,d.rb().isLine()&&2===d.rt().lcnt()&&d.rt().isLineStraight()&&e++,e>=2){if(this.checkOnly)return!1;a&&b.border.seterr(-1),d.setErrorPearl(),a=!1}}}return a},checkBlackPearl2:function(){for(var a=!0,b=this.owner.board,c=0;c<b.cellmax;c++){var d=b.cell[c];if(2===d.getQnum()&&2===d.lcnt()&&(d.ub().isLine()&&2===d.up().lcnt()&&!d.up().isLineStraight()||d.db().isLine()&&2===d.dn().lcnt()&&!d.dn().isLineStraight()||d.lb().isLine()&&2===d.lt().lcnt()&&!d.lt().isLineStraight()||d.rb().isLine()&&2===d.rt().lcnt()&&!d.rt().isLineStraight())){if(this.checkOnly)return!1;a&&b.border.seterr(-1),d.setErrorPearl(),a=!1}}return a}},FailCode:{mashuOnLine:["線が上を通っていない丸があります。","Lines don't pass some pearls."],mashuWCurve:["白丸の上で線が曲がっています。","Lines curve on white pearl."],mashuWStNbr:["白丸の隣で線が曲がっていません。","Lines go straight next to white pearl on each side."],mashuBStrig:["黒丸の上で線が直進しています。","Lines go straight on black pearl."],mashuBCvNbr:["黒丸の隣で線が曲がっています。","Lines curve next to black pearl."]}});