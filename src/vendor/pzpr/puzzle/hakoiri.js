/*! @license pzpr.js v3.4.0-pre (c) 2009-2014 sabo2, MIT license
 *   https://bitbucket.org/sabo2/pzprv3 */
pzpr.createCustoms("hakoiri",{MouseEvent:{mouseinput:function(){this.owner.playmode?this.btn.Left?this.mousestart&&this.inputqnum():this.btn.Right&&this.mousemove&&this.inputDot():this.owner.editmode&&(this.mousestart||this.mousemove)&&this.inputborder(),this.mouseend&&this.notInputted()&&(this.mouseCell=this.owner.board.emptycell,this.inputqnum())},inputDot:function(){var a=this.getcell();a.isnull||a===this.mouseCell||-1!==a.getQnum()||(null===this.inputData&&(this.inputData=1===a.getQsub()?0:1),a.setAnum(-1),a.setQsub(1===this.inputData?1:0),this.mouseCell=a,a.draw())}},KeyEvent:{enablemake:!0,enableplay:!0,keyinput:function(a){this.key_hakoiri(a)},key_hakoiri:function(a){"1"===a||"q"===a||"a"===a||"z"===a?a="1":"2"===a||"w"===a||"s"===a||"x"===a?a="2":"3"===a||"e"===a||"d"===a||"c"===a?a="3":"4"===a||"r"===a||"f"===a||"v"===a?a="s1":("5"===a||"t"===a||"g"===a||"b"===a)&&(a=" "),this.key_inputqnum(a)}},Cell:{numberAsObject:!0,maxnum:3},Board:{isborder:1},AreaNumberManager:{enabled:!0},AreaRoomManager:{enabled:!0},Graphic:{initialize:function(){this.Common.prototype.initialize.call(this),this.bcolor=this.bcolor_GREEN,this.bbcolor="rgb(127, 127, 127)",this.dotcolor=this.dotcolor_PINK},paint:function(){this.drawBGCells(),this.drawGrid(),this.drawBorders(),this.drawDotCells(!0),this.drawQnumMarks(),this.drawHatenas(),this.drawChassis(),this.drawCursor()},drawQnumMarks:function(){var a=this.vinc("cell_mark","auto"),b=.3*this.cw,c=.26*this.cw,d=["c_mk1_","c_mk2_","c_mk3_"];a.lineWidth=2;for(var e=this.range.cells,f=0;f<e.length;f++){var g=e[f],h=g.id,i=g.getNum();if(this.vhide([d[0]+h,d[1]+h,d[2]+h]),!(0>=i)){a.strokeStyle=this.getCellNumberColor(g);var j=g.bx*this.bw,k=g.by*this.bh;if(this.vnop(d[i-1]+h,this.STROKE))switch(i){case 1:a.strokeCircle(j,k,b);break;case 2:a.setOffsetLinePath(j,k,0,-c,-b,c,b,c,!0),a.stroke();break;case 3:a.strokeRect(j-b,k-b,2*b,2*b)}}}}},Encode:{decodePzpr:function(){this.decodeBorder(),this.decodeNumber10()},encodePzpr:function(){this.encodeBorder(),this.encodeNumber10()}},FileIO:{decodeData:function(){this.decodeAreaRoom(),this.decodeCellQnum(),this.decodeCellAnumsub()},encodeData:function(){this.encodeAreaRoom(),this.encodeCellQnum(),this.encodeCellAnumsub()}},AnsCheck:{checkAns:function(){if(!this.checkAroundMarks())return"nmAround";var a=this.owner.board.getRoomInfo();if(!this.checkOverFourMarksInBox(a))return"bkNumGt3";if(!this.checkDiffMarkInBox(a))return"bkDupNum";var b=this.owner.board.getNumberInfo();return this.checkOneArea(b)?this.checkAllMarkInBox(a)?null:"bkNumLt3":"nmDivide"},checkOverFourMarksInBox:function(a){return this.checkAllBlock(a,function(a){return a.isNum()},function(a,b,c){return 3>=c})},checkDiffMarkInBox:function(a){return this.checkDifferentNumberInRoom(a,function(a){return a.getNum()})},checkAllMarkInBox:function(a){return this.checkAllBlock(a,function(a){return a.isNum()},function(a,b,c){return c>=3})},checkAroundMarks:function(){for(var a=!0,b=this.owner.board,c=0;c<b.cellmax;c++){var d=b.cell[c],e=d.getNum();if(!(0>e)){var f=(d.bx,d.by,0),g=new this.owner.CellList,h=function(a){return!a.isnull&&e===a.getNum()};if(g.add(d),f=d.relcell(2,0),h(f)&&g.add(f),f=d.relcell(0,2),h(f)&&g.add(f),f=d.relcell(-2,2),h(f)&&g.add(f),f=d.relcell(2,2),h(f)&&g.add(f),g.length>1){if(this.checkOnly)return!1;g.seterr(1),a=!1}}}return a}},FailCode:{bkDupNum:["1つのハコに同じ記号が複数入っています。","A box has same plural marks."],bkNumGt3:["1つのハコに4つ以上の記号が入っています。","A box has four or more marks."],bkNumLt3:["1つのハコに2つ以下の記号しか入っていません。","A box has tow or less marks."],nmDivide:["タテヨコにつながっていない記号があります。","Marks are devided."],nmAround:["同じ記号がタテヨコナナメに隣接しています。","Same marks are adjacent."]}});