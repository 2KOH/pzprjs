/*! @license pzpr.js v3.4.0-pre (c) 2009-2014 sabo2, MIT license
 *   https://bitbucket.org/sabo2/pzprv3 */
pzpr.createCustoms("wblink",{MouseEvent:{mouseinput:function(){this.owner.playmode?this.btn.Left?this.mousestart||this.mousemove?this.inputLine():this.mouseend&&this.notInputted()&&this.inputpeke():this.btn.Right&&(this.mousestart||this.mousemove)&&this.inputpeke():this.owner.editmode&&this.mousestart&&this.inputqnum()},inputLine:function(){var a=this.getpos(0);if(!this.prevPos.equals(a)){var b=this.getnb(this.prevPos,a);if(!b.isnull){var c=b.getlinesize(),d=this.owner.board.borderinside(c.x1,c.y1,c.x2,c.y2);null===this.inputData&&(this.inputData=b.isLine()?0:1);for(var e=0;e<d.length;e++)1===this.inputData?d[e].setLine():0===this.inputData&&d[e].removeLine();this.inputData=2,this.owner.painter.paintRange(c.x1-1,c.y1-1,c.x2+1,c.y2+1)}this.prevPos=a}},inputpeke:function(){var a=this.getpos(.22),b=a.getb();if(!b.isnull&&!this.prevPos.equals(a)){null===this.inputData&&(this.inputData=2!==b.getQsub()?2:0),b.setQsub(this.inputData);for(var c=b.getlinesize(),d=this.owner.board.borderinside(c.x1,c.y1,c.x2,c.y2),e=0;e<d.length;e++)d[e].setLineVal(0);this.prevPos=a,this.owner.painter.paintRange(c.x1-1,c.y1-1,c.x2+1,c.y2+1)}}},KeyEvent:{enablemake:!0,keyinput:function(a){this.key_inputcircle(a)},key_inputcircle:function(a){var b=this.cursor.getTCC();if("1"==a)b.setQnum(1!==b.getQnum()?1:-1);else if("2"==a)b.setQnum(2!==b.getQnum()?2:-1);else if("-"==a)b.setQnum(-2!==b.getQnum()?-2:-1);else{if("3"!=a&&" "!=a)return;b.setQnum(-1)}b.draw()}},Cell:{numberAsObject:!0,maxnum:2},Border:{getlinesize:function(){var a=this.getaddr(),b=a.clone();if(this.isVert()){for(;a.move(-1,0).getc().noNum();)a.move(-1,0);for(;b.move(1,0).getc().noNum();)b.move(1,0)}else{for(;a.move(0,-1).getc().noNum();)a.move(0,-1);for(;b.move(0,1).getc().noNum();)b.move(0,1)}return a.getc().isnull||b.getc().isnull?{x1:-1,y1:-1,x2:-1,y2:-1}:{x1:a.bx,y1:a.by,x2:b.bx,y2:b.by}}},Board:{qcols:8,qrows:8,isborder:1},LineManager:{isCenterLine:!0},AreaLineManager:{enabled:!0},Graphic:{initialize:function(){this.Common.prototype.initialize.call(this),this.gridcolor=this.gridcolor_THIN,this.errbcolor1="white",this.circleratio=[.35,.3],this.lwratio=8},paint:function(){this.drawGrid(!1,this.owner.editmode&&!this.outputImage),this.drawPekes(),this.drawLines(),this.drawCircles(),this.drawHatenas(),this.drawTarget()},getCircleStrokeColor:function(a){return 1===a.qnum?1===a.error?this.errcolor1:this.cellcolor:null},getCircleFillColor:function(a){return 1===a.qnum?1===a.error?this.errbcolor1:"white":2===a.qnum?1===a.error?this.errcolor1:this.cellcolor:null}},Encode:{decodePzpr:function(){this.decodeCircle()},encodePzpr:function(){this.encodeCircle()}},FileIO:{decodeData:function(){this.decodeCellQnum(),this.decodeBorderLine()},encodeData:function(){this.encodeCellQnum(),this.encodeBorderLine()}},AnsCheck:{checkAns:function(){if(!this.checkLineCount(4))return"lnCross";var a=this.owner.board.getLareaInfo();return this.checkTripleObject(a)?this.checkWBcircle(a,1)?this.checkWBcircle(a,2)?this.checkAloneCircle()?null:"nmIsolate":"lcInvBlack":"lcInvWhite":"lcTripleNum"},checkAloneCircle:function(){return this.checkAllCell(function(a){return 0===a.lcnt()&&a.isNum()})},checkWBcircle:function(a,b){for(var c=!0,d=1;d<=a.max;d++){var e=a.room[d].clist;if(!(e.length<=1)){var f=e[0],g=e[e.length-1];if(f.getQnum()===b&&g.getQnum()===b){if(this.checkOnly)return!1;c&&this.owner.board.border.seterr(-1),a.setErrLareaById(d,1),f.seterr(1),g.seterr(1),c=!1}}}return c}},FailCode:{lcTripleNum:["3つ以上の○が繋がっています。","Three or more objects are connected."],lcInvWhite:["白丸同士が繋がっています。","Two white circles are connected."],lcInvBlack:["黒丸同士が繋がっています。","Two black circles are connected."],nmIsolate:["○から線が出ていません。","A circle doesn't start any line."]}});